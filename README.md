# Assembler

**Description**
  - Assembler for my [8bit cpu](https://github.com/dma-neves/8bcpu) written in python.
  - Given a `.s` file with assembly code, the assembler.py program generates the corresponding bytecode. The generated bytecode can be stored in a file containing raw binary data (`.binary`) or containing a string with the corresponding 0s and 1s (`.strbinary`).
  -  A `.strbinary` file can then be used with the romGenerator.py program to generate the VHDL file for the ROM (256 bytes) the CPU uses.
  
**Syntax**
  - [ISA](https://github.com/dma-neves/8bcpu/blob/main/other/ISA/ISA.txt)
  - Instead of directly using the memory locations for jump instructions the assembler allows the usage of labels.
  - The "#" and ';' characters can be used for comments. Comments cannot be placed on the same line as a instruction.
  - To facilitate debugging, a `break` instruction was also added that can be used with the [emulator](https://github.com/dma-neves/8bcpuEmulator).
  - To reduce code repetition, six macros were added to the assembler:

  ```
  lod $V RX:
    lod $254 ADR
    str $V [ADR]
    lod [ADR] RX

  psh ($V or RX):
    lod SP ADR
    str ($V or RX) [ADR]
    inc SP
    lod ACR SP 

  pop RX:
    dec SP
    lod ACR SP
    lod SP ADR
    lod [ADR] RX

  pop:
    dec SP
    lod ACR SP

  lsr $V RX (Load Stack variable to Register):
    sub SP $pos
    lod ACR ADR
    lod [ADR] RX

  srs RX $V (Store Register to Stack variable):
    sub SP $V
    lod ACR ADR
    str RX [ADR]
  ```
  
**Example**
  ![alt text](https://github.com/dma-neves/Assembler/blob/main/other/code.png)
